@model MainViewModel

@{
    ViewData["Title"] = "Main";
}

<div class="container-content-common">
    <div class="content-block">
        <h1 class="font-family-1 h1-standart-page gold-text">Главная</h1>
    </div>

    <div class="content-block">
        <div class="buttons-panel">
            <div class="buttons-panel-block">
                <form id="SelectPresetForm" asp-area="" asp-controller="Main" asp-action="ShowSelectedPreset" method="post">
                    <button class="button button-text-left button-max-width main-button-select-preset" type="button">
                        <span class="large-text font-family-2 black-text">&#129095; Выбрать пресет</span>
                    </button>
                    <div class="block-absolute-max-width block-select-preset-collapse">
                        <div class="select-block block-select-preset-list-block">
                            @if (Model.PresetInfos != null && Model.PresetInfos.Count > 0)
                            {
                                var presetInfos = Model.PresetInfos;

                                bool isCheckedWas = false;
                                <ul class="select-list">
                                    @foreach (PresetInfo presetInfo in presetInfos)
                                    {
                                        <li class="select-list-item">
                                            @if (isCheckedWas)
                                            {
                                                <input class="select-point" type="radio" name="presetId" id="preset-@presetInfo.Id" value="@presetInfo.Id" />
                                            }
                                            else
                                            {
                                                <input class="select-point" type="radio" name="presetId" id="preset-@presetInfo.Id" value="@presetInfo.Id" checked />
                                            }
                                            <label class="text font-family-2 black-text select-label" for="preset-@presetInfo.Id">@presetInfo.PresetName</label>
                                        </li>
                                        isCheckedWas = true;
                                    }
                                </ul>
                            }
                        </div>
                        <div class="block-select-preset-button-block">
                            <button class="button button-max-width select-preset-submit-button" type="submit">
                                <span class="large-text font-family-2 black-text">Подтвердить</span>
                            </button>
                        </div>
                    </div>
                </form>
            </div>
            <div class="buttons-panel-block">
                <form id="CreatePresetForm" asp-area="" asp-controller="Main" asp-action="CreatePreset" method="get">
                    <button class="button button-text-left button-max-width main-button-create-preset" type="button">
                        <span class="large-text font-family-2 black-text">&#10084; Опубликовать</span>
                    </button>
                </form>
            </div>
            <div class="buttons-panel-block">
                <form id="DeletePresetForm" asp-area="" asp-controller="Main" asp-action="DeletePreset" method="get">
                    <button class="button button-text-left button-max-width main-button-delete-preset" type="button">
                        <span class="large-text font-family-2 black-text">&#10006; Удалить</span>
                    </button>
                </form>
            </div>
            <div class="buttons-panel-block">
                <form id="UpdatePresetForm" asp-area="" asp-controller="Main" asp-action="UpdatePreset" method="get">
                    <button class="button button-text-left button-max-width main-button-update-preset" type="button">
                        <span class="large-text font-family-2 black-text">&#9209; Создать</span>
                    </button>
                </form>
            </div>
        </div>
    </div>

    @if (Model.MainPageModel != null)
    {
        var mainPageModel = Model.MainPageModel;

        <div class="content-block">
            <p class="middle-text font-family-2 gold-text paragraph">
                На&nbsp;главной странице гостевого сайта отображается опубликованный пресет. Чтобы поменять его необходимо
                выбрать другой пресет и&nbsp;нажать кнопку &laquo;Опубликовать&raquo;. Изменения&nbsp;же, которые вы&nbsp;
                вносите в&nbsp;выбраном пресете, вступают в&nbsp;силу сразу для этого пресета, включая и&nbsp;опубликованный. Поэтому для эксперементов лучше создать новый или использовать один из&nbsp;неопубликованных.
            </p>
        </div>

        @if (mainPageModel.Id > 0)
        {
            <div class="content-block">
                <h2 class="h2-standart-page font-family-1 gold-text">Название пресета: @mainPageModel.PresetName</h2>
            </div>

            <div class="content-block">
                @if (mainPageModel.IsPublished)
                {
                    <div class="is-published-or-not-block">
                        <span class="biggest-text font-family-2 green-text">Опубликован</span>
                    </div>
                }
                else
                {
                    <div class="is-published-or-not-block">
                        <span class="biggest-text font-family-2 blue-text">Не опубликован</span>
                    </div>
                }
            </div>
        }
        else
        {
            <div class="content-block">
                <p class="middle-text font-family-2 gold-text paragraph">
                    В&nbsp;данный момент нет ни&nbsp;одного опубликованного пресета. Используется пресет по&nbsp;умолчанию.
                    Изменять пресет по&nbsp;умолчанию запрещено. Публикация и&nbsp;удаление пресета по&nbsp;умолчанию ни&nbsp;
                    к&nbsp;чему не&nbsp;приведёт. Необходимо выбрать один из&nbsp;неопубликованных или создать новый.
                    Для создания нового пресета нажмите кнопку &laquo;Создать&raquo;.
                </p>
            </div>
            <div class="content-block">
                <h2 class="h2-standart-page font-family-1 gold-text">@mainPageModel.PresetName</h2>
            </div>
        }

        <div class="content-block preset-content-block">
            <p class="middle-text font-family-2 black-text paragraph">@mainPageModel.Text</p>
        </div>

        <div class="content-block">
            <p class="middle-text font-family-2 gold-text paragraph">
                Если изображение отсутствует, элементы внутни него отображаться на&nbsp;странице сайта не&nbsp;будут,
                как и&nbsp;само изображение. Если вам необходимо сделать так, чтобы внутренние элементы отображались,
                добавтье изображение.
            </p>
        </div>

        string presetContentImageStyle;
        string presetContentMissingImageStyle;
        if (!string.IsNullOrEmpty(@mainPageModel.Image))
        {
            presetContentImageStyle = "3px solid #4e00a0;";
            presetContentMissingImageStyle = "display: none;";
        }
        else
        {
            presetContentImageStyle = "5px dashed #4e00a0;";
            presetContentMissingImageStyle = "display: block;";
        }

        <div class="content-block preset-content-img" style="background-image: url('@mainPageModel.Image'); outline: @presetContentImageStyle">
            @{
                string buttonContent;
                string buttonStylesContent;
            }

            @if (!string.IsNullOrEmpty(@mainPageModel.Button))
            {
                buttonContent = @mainPageModel.Button;
                buttonStylesContent = "background-color: #e31776;";
            }
            else
            {
                buttonContent = "Кнопка отсутствует";
                buttonStylesContent = "outline: 5px dashed #e31776;";
            }

            <div class="preset-content-img-button-block">
                <div class="preset-button-shell" style="@buttonStylesContent">
                    <span class="preset-button-content biggest-text font-family-2 white-text">@buttonContent</span>
                </div>
            </div>

            <div class="preset-content-img-image-missing-block" style="@presetContentMissingImageStyle">
                <span class="biggest-text font-family-2 gold-text">Изображение отсутствует</span>
            </div>

            @{
                string phrase;
                string phraseStyles;
            }
            @if (!string.IsNullOrEmpty(@mainPageModel.Phrase))
            {
                phrase = @mainPageModel.Phrase;
                phraseStyles = "";
            }
            else
            {
                phrase = "Фраза отсутствует";
                phraseStyles = "outline: 5px dashed #4e00a0;";
            }

            <div class="preset-content-img-phrase-block">
                <div class="preset-phrase-shell" style="@phraseStyles">
                    <span class="preset-phrase-content mega-text font-family-2 white-text">@phrase</span>
                </div>
            </div>
        </div>


        <div class="content-block preset-content-block">
            <div class="preset-input-block">
                <div class="input-block-header">
                    <span class="biggest-text font-family-2 black-text">@mainPageModel.Action</span>
                </div>
                <div class="input-block-top">
                    <div class="input-block-top-item input-block-item">
                        <span class="input-block-label middle-text font-family-2 black-text">Имя</span>
                        <div class="input-block-field"></div>
                    </div>
                    <div class="input-block-top-item input-block-item">
                        <span class="input-block-label middle-text font-family-2 black-text">E-mail</span>
                        <div class="input-block-field"></div>
                    </div>
                </div>
                <div class="input-block-middle-item">
                    <div class="input-block-item">
                        <span class="input-block-label middle-text font-family-2 black-text">Текст сообщения</span>
                        <div class="input-block-field"></div>
                    </div>
                </div>
                <div class="preset-input-block-bottom">
                    <div class="input-block-button">
                        <span class="biggest-text font-family-2 white-text">Отправить</span>
                    </div>
                </div>
            </div>
        </div>
    }
    else
    {

    }
</div>

@section Scripts
{
<script>
    $(function() {
        $(".buttons-panel-block").on("click", ".main-button-select-preset", function(e) {
            var collapsable = $(this).closest(".buttons-panel-block");
            if(collapsable.hasClass("expanded"))
            {
                collapsable.removeClass("expanded");
            }
            else
            {
                collapsable.addClass("expanded");
            }
        });
    });
</script>
}